# SharePoint Sync Function - Environment Configuration
# ====================================================
# Copy this file to .env and update the values for local testing
# For Azure deployment, these are set as Function App Settings

# ==============================================================================
# Azure Configuration
# ==============================================================================

# Your Azure subscription ID
SUBSCRIPTION_ID=your-subscription-id

# Resource group for the Function App
RESOURCE_GROUP=rg-sharepoint-sync

# Azure region
LOCATION=francecentral

# ==============================================================================
# Function App Configuration  
# ==============================================================================

# Name of the Function App (must be globally unique)
FUNCTION_APP_NAME=func-sharepoint-sync

# Storage account for Function App internals (auto-generated if not set)
# STORAGE_ACCOUNT_FUNC=stfuncspsync

# App Service Plan name
APP_SERVICE_PLAN=asp-sharepoint-sync

# ==============================================================================
# SharePoint Configuration
# ==============================================================================

# Full URL to your SharePoint site
SHAREPOINT_SITE_URL=https://your-tenant.sharepoint.com/sites/your-site

# Document library name (usually "Documents")
SHAREPOINT_DRIVE_NAME=Documents

# Folder path within the document library (use "/" for root)
SHAREPOINT_FOLDER_PATH=/

# ==============================================================================
# Target Blob Storage
# ==============================================================================

# Storage account name where files will be synced to
AZURE_STORAGE_ACCOUNT_NAME=your-storage-account

# Container name for synced files
AZURE_BLOB_CONTAINER_NAME=sharepoint-files

# ==============================================================================
# Sync Settings
# ==============================================================================

# Set to "true" to delete blobs that no longer exist in SharePoint
DELETE_ORPHANED_BLOBS=true

# Set to "true" to sync SharePoint file permissions to blob metadata
SYNC_PERMISSIONS=true

# ==============================================================================
# Timer Schedule
# ==============================================================================

# CRON expression for when to run the sync
# Default: Run at 2:00 AM UTC every day
# Format: {second} {minute} {hour} {day} {month} {day-of-week}
TIMER_SCHEDULE=0 0 2 * * *

# Examples:
# Every hour:     0 0 * * * *
# Every 6 hours:  0 0 */6 * * *
# Daily at 2 AM:  0 0 2 * * *
# Weekly Sunday:  0 0 2 * * 0

# ==============================================================================
# Development/Debug
# ==============================================================================

# Set to "true" to create resources without deploying the function
DRY_RUN=false
