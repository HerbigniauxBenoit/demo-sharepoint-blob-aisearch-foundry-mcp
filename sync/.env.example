# SharePoint Sync to Blob - Environment Variables
# Copy this file to .env and fill in your values

# ==========================
# Authentication Options
# ==========================
# The application uses DefaultAzureCredential which supports multiple auth methods:
#
# 1. App Registration (Client Credentials) - Set all three variables below:
#    Best for: Local testing with Sites.Selected permission
#
# 2. Managed Identity - Leave these empty (used in Azure Container Apps)
#    Best for: Production deployment
#
# 3. Azure CLI - Leave these empty, run 'az login' first
#    Best for: Quick local testing with your own permissions

# Option 1: App Registration credentials (uncomment and fill in)
# AZURE_CLIENT_ID=your-client-id
# AZURE_CLIENT_SECRET=your-client-secret
# AZURE_TENANT_ID=your-tenant-id

# ==========================
# SharePoint Configuration
# ==========================
# The full URL to your SharePoint site
SHAREPOINT_SITE_URL=https://contoso.sharepoint.com/sites/MySite

# Document library name (default: "Documents")
SHAREPOINT_DRIVE_NAME=Documents

# Folder path within the document library (default: "/" for root)
SHAREPOINT_FOLDER_PATH=/

# ==========================
# Azure Blob Storage
# ==========================
# Storage account name (without .blob.core.windows.net)
AZURE_STORAGE_ACCOUNT_NAME=yourstorageaccount

# Container name for synced files
AZURE_BLOB_CONTAINER_NAME=sharepoint-sync

# Optional prefix for all blobs (e.g., "docs/")
AZURE_BLOB_PREFIX=

# ==========================
# Sync Settings
# ==========================
# Set to "true" to delete blobs that no longer exist in SharePoint
DELETE_ORPHANED_BLOBS=false

# Set to "true" to preview changes without making actual modifications
DRY_RUN=false

# Set to "true" to sync SharePoint file permissions to blob metadata
# This enables document-level security with Azure AI Search
SYNC_PERMISSIONS=true

# ==========================
# Optional: Separate Storage Credentials
# ==========================
# Use these if your storage account is in a different tenant than SharePoint
# AZURE_STORAGE_TENANT_ID=storage-tenant-id
# AZURE_STORAGE_CLIENT_ID=storage-client-id
# AZURE_STORAGE_CLIENT_SECRET=storage-client-secret
